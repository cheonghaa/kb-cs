### 컨텍스트 스위칭(Context Switching)

컨텍스트 스위칭이란, 'CPU/코어에서 실행 중이던 프로세스/스레드가 다른 프로세스/스레드로 교체되는 것'입니다.
- 컨텍스트란 프로세스/스레드의 상태를 의미합니다. 또 이 상태라는 것은 CPU, 메모리에서의 상태를 의미합니다. 

### 동작과정
1. 현재 프로세스의 상태 저장
   - 현재 실행 중인 프로세스의 레지스터 값, 프로그램 카운터, 스택 포인터 등의 상태 정보를 PCB(Process Control Block)에 저장
2. 새로운 프로세스 선택
   - 운영 체제의 스케줄러가 실행할 다음 프로세스를 선택
3. 새 프로세스의 상태 복원
   - 선택된 프로세스의 상태 정보를 PCB에서 읽어와 레지스터, 프로그램 카운터, 스택 포인터 등에 복원
4. 프로세스 실행 재개
   - 새롭게 선택된 프로세스의 실행을 시작

### 프로세스와 스레드의 컨텍스트 스위칭 차이

- **프로세스 컨텍스트 스위칭**:
    - 전체 주소 공간, 페이지 테이블, 파일 디스크립터 등의 정보가 저장되고 로드
    - 상대적으로 많은 오버헤드가 발생
- **스레드 컨텍스트 스위칭**:
    - 동일한 프로세스 내에서 발생하므로 주소 공간과 파일 디스크립터 등을 공유
    - 스택 포인터와 프로그램 카운터 등 스레드별 레지스터 정보만 저장하고 로드
    - 프로세스 컨텍스트 스위칭보다 오버헤드가 적다.
    

### 컨텍스트 스위칭 시 정보 저장 형식

- 기존 프로세서의 정보는 프로세스 제어 블록(PCB)에 저장

  - 프로세스 ID
  - 프로세스 상태
  - 프로그램 카운터
  - CPU 레지스터 값
  - 메모리 관리 정보
  - 계정 정보
- 커널 스택에는 현재 프로세스의 스택 프레임과 레지스터 값이 저장

### 컨텍스트 스위칭이 발생 시기

- **시분할 시스템**
    
    시간 할당량이 끝나면 스케줄러가 다른 프로세스로 전환합니다.
    
- **입출력 작업**
    
    프로세스가 I/O 요청을 하면, 해당 작업이 완료될 때까지 대기 상태로 전환됩니다.
    
- **우선순위 변화 시**
    
    더 높은 우선순위의 프로세스가 준비 상태가 되면 전환됩니다.
    
- **인터럽트 발생 시**
    
    하드웨어 인터럽트가 발생하면, 현재 프로세스를 중단하고 인터럽트 핸들러를 실행합니다.
    
- **사용자 요청 시**
    
    시스템 호출을 통해 명시적으로 프로세스 전환을 요청할 때 발생합니다.
